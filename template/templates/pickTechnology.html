<div id="techChoiceMenu" style="text-align:center">
    <h2>Weâ€™d like to hear your experiences with different types of online platforms. </h2>
    <p>Click below to choose the online platform that you would like to draw tarot cards for. </p>
    <!-- The four columns -->
    <div id="tech-local-commerce" class="row">
        <h2 style="text-align: left">Local Commerce</h2>
        <div class="column">
            <img src="../img/tech-fbmarketplace.jpg"
                 name="Facebook"
                 alt="Facebook Marketplace is an embedded Facebook app to buy and sell items or services."
                 style="width:100%" onclick="selectTechnology(this);">
        </div>
        <div class="column">
            <img src="../img/tech-offerup.png"
                 name="OfferUp"
                 alt="OfferUp is an online mobile-first marketplace with an emphasis on in-person transactions."
                 style="width:100%" onclick="selectTechnology(this);">
        </div>
        <div class="column">
            <img src="../img/tech-nextdoor.png"
                 name="Nextdoor"
                 alt="Nextdoor is a hyperlocal social networking service for neighborhoods."
                 style="width:100%" onclick="selectTechnology(this);">
        </div>
    </div>
    <div id="tech-dating" class="row">
        <h2 style="text-align: left">Dating</h2>
        <div class="column">
            <img src="img/tech-tinder.jpg"
                 name="Tinder"
                 alt="Tinder is an online dating application that allows users to anonymously swipe to like or dislike other profiles based on their photos, a small bio, and common interests."
                 style="width:100%" onclick="selectTechnology(this);">
        </div>
        <div class="column">
            <img src="img/tech-grindr.png"
                 name="Grindr"
                 alt="Grindr is an online dating application geared towards gay, bi and trans people."
                 style="width:100%" onclick="selectTechnology(this);">
        </div>
        <div class="column">
            <img src="img/tech-farmersonly.png"
                 name="FarmersOnly"
                 alt="FarmersOnly is a niche dating site that aims to help rural dwellers find dates with singles who understand their lifestyle and uphold the same values."
                 style="width:100%" onclick="selectTechnology(this);">
        </div>
    </div>
    <div id="tech-transportation" class="row">
        <h2 style="text-align: left">Transportation</h2>
        <div class="column">
            <img src="img/tech-lyft.png"
                 name="Lyft"
                 alt="Lyft is a ridesharing company offering car rides, scooters, a bicycle-sharing system, and a food delivery service."
                 style="width:100%" onclick="selectTechnology(this);">
        </div>
        <div class="column">
            <img src="img/tech-uber.jpg"
                 name="Uber"
                 alt="Uber is a ride-hailing company offering ridesharing, ride service hailing, food delivery, and a micromobility system with electric bikes and scooters."
                 style="width:100%" onclick="selectTechnology(this);">
        </div>
        <div class="column">
            <img src="img/tech-libretaxi.png"
                 name="LibreTaxi"
                 alt="LibreTaxi is a free and open source alternative to Uber/Lyft connecting passengers and drivers."
                 style="width:100%" onclick="selectTechnology(this);">
        </div>
    </div>

</div>

<div id="techForm" style="display: none">
    <h3>I use the online platform:</h3><br>
    <input type="radio" id="option1" name="techuse" value="daily">
    <label for="option1">Daily</label><br>
    <input type="radio" id="option2" name="techuse" value="often">
    <label for="option2">Often</label><br>
    <input type="radio" id="option3" name="techuse" value="sometimes">
    <label for="option3">Sometimes</label><br>
    <input type="radio" id="option4" name="techuse" value="never">
    <label for="option4">Never</label><br><br>
    <input type="submit" value="Submit" class="btn btn-primary btn-lg" onclick="saveForm()">
</div>

<div id="tarotCards" style="display: none">

    <div id="cardContainer" class="cardcontainer">
        <div class="card" id="card1Box">
            <div class="thumb">
                <img src="../img/card-Catalyst.png" onclick="cardClick('card1')" style="position: absolute">
                <svg viewBox="0 0 16 16" class="bi bi-check-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                     style="position: absolute;display: none" width="3em" height="3em">
                    <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"></path>
                </svg>
            </div>
        </div>
        <div class="card" id="card2Box">
            <div class="thumb">
                <img src="../img/card-Forgotten.png" onclick="cardClick('card2')" style="position: absolute">
                <svg viewBox="0 0 16 16" class="bi bi-check-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                     style="position: absolute;display: none" width="3em" height="3em">
                    <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"></path>
                </svg>
            </div>
        </div>
        <div class="card" id="card3Box">
            <div class="thumb">
                <img src="../img/card-RadioStar.png" onclick="cardClick('card3')" style="position: absolute">
                <svg viewBox="0 0 16 16" class="bi bi-check-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                     style="position: absolute;display: none" width="3em" height="3em">
                    <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"></path>
                </svg>
            </div>
        </div>
        <div class="card" id="card4Box">
            <div class="thumb">
                <img src="../img/card-Scandal.png" onclick="cardClick('card4')" style="position: absolute">
                <svg viewBox="0 0 16 16" class="bi bi-check-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                     style="position: absolute;display: none" width="3em" height="3em">
                    <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"></path>
                </svg>
            </div>
        </div>
        <div class="card" id="card5Box">
            <div class="thumb">
                <img src="../img/card-ServiceDog.png" onclick="cardClick('card5')" style="position: absolute">
                <svg viewBox="0 0 16 16" class="bi bi-check-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                     style="position: absolute;display: none" width="3em" height="3em">
                    <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"></path>
                </svg>
            </div>
        </div>
    </div>

    <div id="flipContainer" class="topcontainer" style="display: none">
        <div id="card1Flip" class="flipcard" onclick="cardFlip('card1')">
            <div id="Card1Flipper" class="card" style="background-color: #11f897">
                <h2>The Catalyst</h2>
                <h3>How might rural cultural habits change how the product is used, adapted, or repurposed?</h3>
                <p>How bringing [the product] to a rural area would impact the rural environment and its features?</p>
                <p>How might [the product] change the cultural habits (social norms, etiquette, or traditions) of people living in rural areas?</p>
            </div>
        </div>
        <div id="card2Flip" class="flipcard" onclick="cardFlip('card2')">
            <div id="Card2Flipped" class="card" style="background-color: #ffbe9f">
                <h2>The Forgotten</h2>
                <h3>When you picture the user base of [the product], who do you think is excluded as a potential user?</h3>
                <p>If [rural users] used [the product], what would their experience be like?</p>
                <p>How can we change [the product] to better serve or design for [rural users]</p>
            </div>
        </div>
        <div id="card3Flip" class="flipcard" onclick="cardFlip('card3')">
            <div id="Card3Flipped" class="card" style="background-color: #aedf2a">
                <h2>The Radio Star</h2>
                <h3>What social or economic interaction disappears if your product is successful in rural contexts?</h3>
                <p>Who loses their job if [the product] is used in rural areas?</p>
                <p>What other local products or services can be replaced by [the product]?</p>
                <p>What rural industries, institutions, or policies would be affected if everyone used [the product]</p>
            </div>
        </div>
        <div id="card4Flip" class="flipcard" onclick="cardFlip('card4')">
            <div id="Card4Flipped" class="card" style="background-color: #15e0ff">
                <h2>The Scandal</h2>
                <h3>If [the product] was entirely dedicated to empowering the lives of rural area population, what kind of impact could it make?</h3>
                <p>Would your use of [the product] make you or others vulnerable to harm or endangering rural culture?</p>
                <p>How can the widespread use of [the product] in rural settings disrupt or endanger environmental and social sustainability in rural contexts?</p>
            </div>
        </div>
        <div id="card5Flip" class="flipcard" onclick="cardFlip('card5')">
            <div id="Card5Flipped" class="card" style="background-color: #ff9400">
                <h2>The Service Dog</h2>
                <h3>If [the product] was entirely dedicated to empowering the lives of rural area population, what kind of impact could it make?</h3>
                <p>Would your use of [the product] make you or others vulnerable to harm or endangering rural culture?</p>
                <p>How can the widespread use of [the product] in rural settings disrupt or endanger environmental and social sustainability in rural contexts?</p>
            </div>
        </div>
    </div>

    <div id="bellowCards" style="display: flex">
        <img src="" style="width: 20em; margin: 10px">
        <div id="controlButtons">
            <input type="submit" value="Change Tech" class="btn btn-primary btn-lg" onclick="changeTech()">
            <input type="submit" value="Submit Answers" class="btn btn-primary btn-lg" onclick="submitAnswers()">
        </div>
        <div id="textboxArea" style="display: none">
            <h3>Please enter you answers below:</h3>
            <textarea id="txtAnswer" type="text" style="width: 90%"></textarea>
            <input type="submit" value="Save" class="btn btn-primary btn-lg" onclick="saveCardAnswer()">
        </div>
    </div>

</div>

<script>

    var all_answers = {};
    var tech_answers = {};

    function selectTechnology(image) {
        var technology = image.name;
        var selected = $('#techChoiceMenu img[name=' + technology + ']');

        $('#techChoiceMenu img').css('filter', 'grayscale(1)');
        selected.css('filter', 'grayscale(0)');

        if(technology in all_answers) {
            tech_answers = all_answers[technology];
        } else {
            tech_answers = resetAnswers();
            tech_answers.tech = technology;
        }
        $('#bellowCards img').attr('src', selected.attr('src'));
        $('#techForm').show();
    }

    function saveForm() {
        $('#techChoiceMenu img').css('filter', 'grayscale(0)');
        // TODO: change form to usage question!!!
        var selected = $("#techForm input:checked");
        tech_answers.use = selected.val();

        console.log(tech_answers);
        selected.prop("checked", false);
        $('#techForm').hide();
        $('#techChoiceMenu').hide();
        $('#tarotCards').show();
    }

    function cardClick(card){
        cardsReset();
        tech_answers.current_card = card;
        var cardBox = $('#' + card + 'Box');
        var cardFlip = $('#' + card + 'Flip');

        $('#flipContainer').css('display', 'flex');
        cardBox.css('opacity', 0);
        cardFlip.css('opacity', 1);
        cardFlip.show();
        $('#txtAnswer').val(tech_answers[tech_answers.current_card]);
        $('#textboxArea').show();
        $('#controlButtons').hide();
    }

    function cardFlip(card) {
        tech_answers.current_card = '';
        var cardBox = $('#' + card + 'Box');
        var cardFlip = $('#' + card + 'Flip');

        $('#flipContainer').hide();
        cardBox.css('opacity', 1);
        cardFlip.css('opacity', 0);
        cardFlip.hide();
        $('#textboxArea').hide();
        $('#controlButtons').show();
    }

    function saveCardAnswer() {
        let answer = $('#txtAnswer').val().trim();
        let cardCheck = $('#' + tech_answers.current_card + 'Box svg');
        if (answer.length > 0) {
            cardCheck.show();
        } else {
            cardCheck.hide();
        }
        tech_answers[tech_answers.current_card] = answer;
        console.log('ANSWERS: ' + JSON.stringify(tech_answers));
        cardsReset();
    }

    function cardsReset() {
        $("div[id$='Box']").css('opacity', 1);
        $("div[id$='Flip']").css('opacity', 0);
        $("div[id$='Flip']").hide();
        $('#flipContainer').hide();
        $('#textboxArea').hide();
        $('#controlButtons').show();
    }

    function resetAnswers() {
        $("div[id$='Box'] svg").hide();
        return {
            tech: '',
            current_card: '',
            use: '',
            card1: '',
            card2: '',
            card3: '',
            card4: ''
        };
    }

    function changeTech() {
        tech_answers = resetAnswers();
        cardsReset();
        $('#tarotCards').hide();
        $('#techChoiceMenu').show();
    }

    function submitAnswers() {
        all_answers[tech_answers.tech] = tech_answers;
        delete tech_answers.current_card;
        LITW.data.submitStudyData(tech_answers);
        changeTech();
    }
</script>